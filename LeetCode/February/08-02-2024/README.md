Time complexity is O(n * sqrt(n)), and the space complexity is O(n).